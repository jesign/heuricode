{"version":3,"sources":["multiplayerController.js","globalController.js","userController.js","navController.js","codeController.js","problemController.js","resultController.js","statprogController.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1eA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC7LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"controllers.js","sourcesContent":["myApp.controller(\"multiplayerController\",[\"$scope\", \"$rootScope\", \"$state\",\r\n\t\"$firebaseArray\", \"userModel\", \"rankService\", \"problemModel\", \"codingService\",\r\n\tfunction($scope, $rootScope, $state, $firebaseArray, userModel, rankService, \r\n\t\tproblemModel, codingService) {\r\n\t\t\r\n\t\t$rootScope.$emit(\"GlobalToggleSidebar\", {});\r\n\r\n\t\tvar refMessages = firebase.database().ref().child(\"messages\");\r\n\t\tvar refPlayer = firebase.database().ref().child(\"players\");\r\n\t\tvar refRoom = firebase.database().ref().child(\"rooms\");\r\n\t\tvar refTimer = firebase.database().ref().child(\"timers\");\r\n\t\t// create a synchronized array\r\n\t  \t$scope.messages = $firebaseArray(refMessages);\r\n\t  \t$scope.players = $firebaseArray(refPlayer);\r\n\t\t$scope.rooms = $firebaseArray(refRoom);\r\n\t\t$scope.timers = $firebaseArray(refTimer);\r\n\t\t\r\n\t  \t// Global Variable\r\n\t  \tvar roomKey = 0;\r\n\t\tvar playerKey = 0;\r\n\t\tvar userId = 0;\r\n\t  \tvar problemIsSet = false;\r\n\t  \tvar p1_id = 0;\r\n\t  \tvar p2_id = 0;\r\n\t  \tvar subj_id = 0;\r\n\t  \tvar problemCode = null;\r\n\t  \tvar leaveState = false;\r\n\r\n\t\t$scope.hasRoom = false;\r\n\t\t$scope.hasOpponent = false;\r\n\t\t$scope.p1_btn = \"disabled\";\r\n\t\t$scope.p2_btn = \"disabled\";\r\n\t\t$scope.p1_name = 0;\r\n\t\t$scope.p2_name = 0;\r\n\t\t$scope.p1_level = 0;\r\n\t\t$scope.p2_level = 0;\r\n\t\t$scope.subject = \"undecided\";\r\n\t  \t$scope.roomIndex = null;\r\n\t\t$scope.timerIndex = null;\r\n\r\n\t\t$scope.loadProblemSuccess = false;\r\n\r\n\t\tfunction setLevel(player, subj){\r\n\t\t\tvar lvl;\r\n\t\t\tswitch(subj){\r\n\t\t\t\tcase 1: \r\n\t\t\t\t\tlvl = rankService.getRankSCS();;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 2: \r\n\t\t\t\t\tlvl = rankService.getRankRCS();;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 3:\r\n\t\t\t\t\tlvl = rankService.getRankARR();;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tif(player === 1){\r\n\t\t\t\t$scope.p1_level = lvl;\r\n\t\t\t}else{\r\n\t\t\t\t$scope.p2_level = lvl;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// function setSubject(subj){\r\n\t\t// \tswitch(subj){\r\n\t //  \t\t\t\t\tcase 1: \r\n\t //  \t\t\t\t\t\t$scope.subject = \"Selection Control Structure\";\r\n\t //  \t\t\t\t\t\tbreak;\r\n\t //  \t\t\t\t\tcase 2:\r\n\t //  \t\t\t\t\t\t$scope.subject = \"Repetition Control Structure\";\r\n\t //  \t\t\t\t\t\tbreak;\r\n\t //  \t\t\t\t\tcase 3: \r\n\t //  \t\t\t\t\t\t$scope.subject = \"Array\";\r\n\t //  \t\t\t\t\t\tbreak;\r\n\t //  \t\t\t\t\tdefault: \r\n\t //  \t\t\t\t}\r\n\t\t// }\r\n\r\n\t\tfunction setProblem(){\r\n\t\t\tproblemModel.getProblem(problemCode)\r\n\t\t\t\t\t.success(function(response){\r\n\t\t\t\t\t\t$scope.loadProblemSuccess = false;\r\n\t\t\t\t\t\t$scope.problemTitle = response.name;\r\n\t\t\t\t\t\t$scope.problemDescription = response.body;\r\n\t\t\t\t\t})\r\n\t\t\t\t\t. error(function(response){\r\n\t\t\t\t\t\t$scope.loadProblemSuccess = false;\r\n\t\t\t\t\t\t$scope.problemTitle = \"Failed to load problem.\";\r\n\t\t\t\t\t});\r\n\t\t\tproblemModel.getProblemDetails(problemCode)\r\n\t\t\t\t\t.success(function(response){\r\n\t\t\t\t\t\tcodingService.setTimeLimit(response.time_limit);\r\n\t\t\t\t\t\tvar time = response.time_limit;\r\n\t\t\t\t\t\tvar hr = parseInt((time / 60) / 60, 10);\r\n\t\t\t\t\t\tvar min = parseInt((time / 60) % 60, 10);\r\n\t\t\t\t\t\tvar sec = parseInt(time % 60, 10);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t$scope.difficulty = response.difficulty;\r\n\t\t\t\t\t\t$scope.time_limit = hr + \"hr/s and \" + min + \"min/s\"\r\n\t\t\t\t\t});\r\n\t\t}\r\n\r\n\t  \t/* player1 creating a room - Step 1*/\r\n\t\tfunction createRoom(){\r\n\t\t\tvar scs = rankService.getRankSCS();\r\n\t\t\tvar rcs = rankService.getRankRCS();\r\n\t\t\tvar arr = rankService.getRankARR();\r\n\r\n\t\t\tconsole.log(\"creating room\");\r\n\t\t\t$scope.rooms.$add({\r\n\t\t\t\tplayer1: userId,\r\n\t\t\t\tplayer2: 0,\r\n\t\t\t\tlevel: {\r\n\t\t\t\t\tscc: scs,\r\n\t\t\t\t\trcs: rcs,\r\n\t\t\t\t\tarr: arr\r\n\t\t\t\t},\r\n\t\t\t\tproblemCode: null,\r\n\t\t\t\tready1: false,\r\n\t\t\t\tready2: false,\r\n\t\t\t\tlang1: \"not set\",\r\n\t\t\t\tlang2: \"not set\", \r\n\t\t\t\tsubject: 0,\r\n\t\t\t\ttime: 5,\r\n\t\t\t\tstatus: 0,\r\n\t\t\t\twinner: 0\r\n\t\t\t}) .then(function(ref){\r\n\t\t\t\tp1_id = userId;\r\n\t\t\t\troomKey = ref.key;\r\n\t\t\t\troomId = true;\r\n\t\t\t\t$scope.roomIndex = $scope.rooms.$indexFor(roomKey);\r\n\t\t\t\t$scope.hasRoom = true;\r\n\t\t\t\tcheckOpponent();\r\n\t\t\t\tconsole.log(\"Room has created\");\r\n\r\n\t\t\t\tuserModel.getPlayerDetails(userId, 1)\r\n\t\t\t\t.success(function(response){\r\n\t\t\t\t\tconsole.log(response);\r\n\t\t\t\t\t$scope.p1_name = response[0];\r\n\t\t\t\t\t$scope.p1_level = 0;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\t/*player1 checking for opponent - Step 2*/\r\n\t\tfunction checkOpponent(){\r\n\t  \t\tvar r = $scope.rooms.$getRecord(roomKey);\r\n\t  \t\tif(!r.player2){\r\n\t  \t\t\tconsole.log('waiting for Opponent...');\r\n\t  \t\t\tsetTimeout(checkOpponent, 1000);\r\n\t  \t\t\treturn;\r\n\t  \t\t}\r\n\r\n\t  \t\tp2_id = r.player2;\r\n\t  \t\tsubj_id = r.subject;\r\n\r\n\t  \t\t$scope.$apply(function(){\r\n\t  \t\t\tuserModel.getPlayerDetails(r.player2, r.subject)\r\n\t  \t\t\t.success(function(response){\r\n\t  \t\t\t\t$scope.p2_name = response[0];\r\n\t  \t\t\t\t$scope.p2_level = response[1];\r\n\t  \t\t\t\t$scope.p1_btn = \"active\";\r\n\t  \t\t\t\t\r\n\t  \t\t\t\tsetLevel(1, r.subject);\r\n\t  \t\t\t\t// setSubject(r.subject);\r\n\t  \t\t\t\tgetProblem();\r\n\t  \t\t\t\t\r\n\t  \t\t\t});\r\n\t        });\r\n\t  \t\treturn;\r\n\t  \t}\r\n\t  \t/* player1 get suitable problems for the 2 players*/\r\n\t  \tfunction getProblem(){\r\n\t\t\tproblemModel.getPlayersProblem(p1_id, p2_id, subj_id)\r\n\t\t\t.success(function(response){\r\n\t\t\t\tconsole.log(response);\r\n\t\t\t\tif(response != 0){\r\n\t\t\t\t\tproblemCode = response;\r\n\t\t\t\t\tcodingService.setProblemCode(response)\r\n\t\t\t\t\tproblemIsSet = true;\r\n\r\n\t\t\t\t\tvar r = $scope.rooms.$getRecord(roomKey);\r\n\t\t\t\t\tr.problemCode = response;\r\n\t\t\t\t\t$scope.rooms.$save(r);\r\n\r\n\r\n\t\t\t\t\tconsole.log(\"Problem has set.\");\r\n\t\t\t\t\tupdateRoomStatus();\r\n\t\t\t\t}else{\r\n\t\t\t\t\talert('There is no more problem to fetch');\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.error(function(){\r\n\t\t\t\talert('There was an error fetching a problem');\r\n\t\t\t});\r\n\t  \t}\r\n\r\n\t  \t/* player1 update room status to 1 - Step 3*/\r\n\t  \tfunction updateRoomStatus(){ \r\n\t\t\tvar r = $scope.rooms.$getRecord(roomKey);\r\n\t\t\tr.status = 1;\r\n  \t\t\tsetProblem();\r\n\r\n\t\t\t$scope.rooms.$save(r).then(function(res){\r\n\t\t\t\t$scope.hasOpponent = true;\r\n  \t\t\t\twaitPlayerReady();\r\n  \t\t\t\tconsole.log(\"waiting for players\");\r\n  \t\t\t});\t\t\t\r\n\t\t\r\n\t  \t}\r\n\r\n\t  \t/* player1 wait for players to get ready - Step 4*/\r\n\t  \tfunction waitPlayerReady(){\r\n\t  \t\tvar r = $scope.rooms.$getRecord(roomKey);\r\n\r\n\t  \t\tif(!r.ready1 || !r.ready2){\r\n\r\n\t  \t\t\tsetTimeout(waitPlayerReady, 1000);\r\n\t  \t\t\treturn;\r\n\t  \t\t}\r\n  \t\t\tstartTimer();\r\n\t  \t\treturn;\r\n\t  \t}\r\n\r\n\t  \t/* player1 start the timer and set\r\n\t\t\tto 2 after 5 seconds \t\t\t- Step 5a */ \r\n\r\n\t  \tfunction startTimer(){\r\n\t  \t\tvar r = $scope.rooms.$getRecord(roomKey);\r\n\r\n\t  \t\tif(r.time != 0){\r\n\t\t  \t\tr.time = r.time - 1;\r\n\r\n\t  \t\t\t$scope.rooms.$save(r);\r\n\r\n\t  \t\t\tsetTimeout(startTimer, 1000);\r\n\t  \t\t\treturn;\r\n\t  \t\t}\r\n\r\n  \t\t\tr.status = 2;\r\n  \t\t\t$scope.rooms.$save(r);\r\n\t\t\tleaveState = true;\r\n\t\t\tcodingService.setWeaknessId(subj_id);\r\n\t\t\tcodingService.setIsEnableCode(true);\r\n\t\t\tcodingService.setIsMultiplayer(true);\r\n\t\t\tcodingService.setRoomKey(roomKey);\r\n\t\t\t$state.go('codingPage');\r\n\t\t\r\n  \t\t\treturn;\r\n\r\n\t  \t}\r\n\t  \t\r\n\r\n\t\t/* player2 wait for the room status to turn to 1 - Step 2*/\r\n\t\tfunction waitRoomReady(){\r\n\t\t\tvar r = $scope.rooms.$getRecord(roomKey);\r\n\r\n\t\t\tif(r.status == 0){\r\n\t\t\t\tconsole.log(\"waiting for room to get ready\");\r\n\t\t\t\tsetTimeout(waitRoomReady, 1000);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tproblemCode = r.problemCode;\r\n\t\t\tconsole.log(\"room available\");\r\n\t\t\tcodingService.setProblemCode(problemCode);\r\n\t\t\tsetProblem();\r\n\t\t\t$scope.$apply(function(){\r\n\t\t\t\t$scope.hasOpponent = true;\r\n\t\t\t});\r\n\r\n\t\t\twaitGameStart();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t/* player 2 wait for the game to start\r\n\t  \t\tor wait for the room status to turn to 2 - Step 3*/\r\n\t\tfunction waitGameStart(){\r\n\t\t\tvar r = $scope.rooms.$getRecord(roomKey);\r\n\r\n\t\t\tif(r.status != 2){\r\n\t\t\t\tsetTimeout(waitGameStart, 1000);\r\n\t\t\t\treturn;\r\n\t\t\t}\t\r\n\t\t\t\r\n\t\t\tleaveState = true;\r\n\t\t\tcodingService.setWeaknessId(subj_id);\r\n\t\t\tcodingService.setIsEnableCode(true);\r\n\t\t\tcodingService.setIsMultiplayer(true);\r\n\t\t\tcodingService.setRoomKey(roomKey);\r\n\t\t\t$state.go('codingPage');\t\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t/* load authenticated user and check for vancant room.*/\r\n\t\tuserModel.getUserId()\r\n\t\t\t.success(function(response){\r\n\t\t\t\tuserId = response;\r\n\t\t\t\t$scope.rooms.$loaded() .then(function(room){\r\n\t\t\t\t/* look for vacant room*/\r\n\t\t\t\t\tconsole.log(\"Checking Vacant Room\");\r\n\r\n\t\t\t\t\tvar scs = rankService.getRankSCS();\r\n\t\t\t\t\tvar rcs = rankService.getRankRCS();\r\n\t\t\t\t\tvar arr = rankService.getRankARR();\r\n\r\n\t\t\t\t\tvar roomId = false;\r\n\r\n\t\t\t\t\tuserModel.checkVacantRoom(room, scs, rcs, arr)\r\n\t\t\t\t\t\t.then(function(response){\r\n\t\t\t\t\t\t\troomKey = response.roomKey;\r\n\t\t\t\t\t\t\t$scope.roomIndex = $scope.rooms.$indexFor(roomKey);\r\n\t\t\t\t\t\t\tconsole.log(\"Got a Room: \" + response.roomKey)\r\n\t\t\t\t\t\t\tvar edit = $scope.rooms.$getRecord(response.roomKey);\r\n\r\n\t\t\t\t\t\t\tedit.player2 = userId;\r\n\t\t\t\t\t\t\t// edit.subject = response.subject;\r\n\r\n\t\t\t\t\t\t\tp1_id = edit.player1;\r\n\t\t\t\t\t\t\tp2_id = userId;\r\n\r\n\t\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\t\t\tif($scope.hasOpponent == false){\r\n\t\t\t\t\t\t\t\t\t\talert(\"The rooom has expired.. please refresh the page..\");\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}, 10000);\r\n\r\n\t\t\t\t\t\t\t/* player 2 joined a room - Step 1*/\r\n\t\t\t\t\t\t\t$scope.rooms.$save(edit).then(function(ref){\r\n\t\t\t\t\t\t\t\tconsole.log('You have joined a room');\r\n\t\t\t\t\t\t\t\t$scope.hasRoom = true;\r\n\t\t\t\t\t\t\t\twaitRoomReady();\r\n\r\n\t\t\t\t\t\t\t\tvar r = $scope.rooms.$getRecord(ref.key);\r\n\r\n\t\t\t\t\t\t\t\tuserModel.getPlayerDetails(r.player1, r.subject)\r\n\t\t\t\t\t\t\t\t.success(function(response){\r\n\t\t\t\t\t\t\t\t\tconsole.log(response);\r\n\t\t\t\t\t\t\t\t\t$scope.p1_name = response[0];\r\n\t\t\t\t\t\t\t\t\t$scope.p1_level = response[1];\r\n\t\t\t\t\t\t\t\t});\t\t\t\r\n\r\n\t\t\t\t\t\t\t\tuserModel.getPlayerDetails(userId, r.subject)\r\n\t\t\t\t\t\t\t\t.success(function(response){\r\n\t\t\t\t\t\t\t\t\tconsole.log(response);\r\n\t\t\t\t\t\t\t\t\t$scope.p2_name = response[0];\r\n\t\t\t\t\t\t\t\t\t$scope.p2_level = response[1];\r\n\t\t\t\t\t\t\t\t});\t\t\t\r\n\t\t\t\t\t\t\t\t// setSubject(r.subject);\r\n\t\t\t\t\t\t\t\t$scope.p2_btn = \"active\";\r\n\t\t\t\t\t\t\t});\t\t\r\n\t\t\t\t\t\t\troomId = true;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.catch(function(response){\r\n\t\t\t\t\t\t\tconsole.log(\"No room yet.\")\r\n\t\t\t\t\t\t\tcreateRoom();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t});\t\t\r\n\t\t\t});\r\n\r\n\t\t$scope.ready1 = function(){\r\n\t\t\tif(p1_id == userId){\r\n\t\t\t\tvar edit = $scope.rooms.$getRecord(roomKey);\r\n\t\t\t\tif(edit.lang1 != \"not set\"){\r\n\t\t\t\t\tedit.ready1 = true;\r\n\t\t\t\t\t$scope.rooms.$save(edit).then(function(){\r\n\t\t\t\t\t\tconsole.log(\"player1 is ready\");\r\n\t\t\t\t\t});\t\t\t\t\r\n\t\t\t\t}else{\r\n\t\t\t\t\talert(\"language not set\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/* Ready buttons */\r\n\t\t$scope.ready2 = function(){\r\n\t\t\tif(p2_id == userId){\r\n\t\t\t\tvar edit = $scope.rooms.$getRecord(roomKey);\r\n\t\t\t\tif(edit.lang2 != \"not set\"){\r\n\t\t\t\t\tedit.ready2 = true;\r\n\t\t\t\t\t$scope.rooms.$save(edit).then(function(){\r\n\t\t\t\t\t\tconsole.log(\"player2 is ready\");\t\t\t\t\r\n\t\t\t\t\t});\r\n\t\t\t\t}else {\r\n\t\t\t\t\talert(\"language not set\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/* Player1 dropdown button - choose language */\r\n\t\t$scope.p1_switchLanguage = function(l_code){\r\n\t\t\tif(p1_id == userId){\r\n\t\t\t\tvar edit = $scope.rooms.$getRecord(roomKey);\r\n\t\t\t\tif(l_code == 11){\r\n\t\t\t\t\tedit.lang1 = \"C\";\r\n\t\t\t\t} else if(l_code == 1){\r\n\t\t\t\t\tedit.lang1 = \"C++\";\r\n\t\t\t\t} else if(l_code == 10){\r\n\t\t\t\t\tedit.lang1 = \"Java\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcodingService.setLanguage(l_code);\r\n\r\n\t\t\t\t$scope.rooms.$save(edit).then(function(){\r\n\t\t\t\t\tconsole.log(\"player2 is ready\");\t\t\t\t\r\n\t\t\t\t});\r\n\t\t\t}else{\r\n\t\t\t\talert(\"you cannot set language from other player.\")\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t\t/* Player2 dropdown button - choose language */\r\n\t\t$scope.p2_switchLanguage = function(l_code){\r\n\t\t\tif(p2_id == userId){\r\n\t\t\t\tvar edit = $scope.rooms.$getRecord(roomKey);\r\n\t\t\t\tif(l_code == 11){\r\n\t\t\t\t\tedit.lang2 = \"C\";\r\n\t\t\t\t} else if(l_code == 1){\r\n\t\t\t\t\tedit.lang2 = \"C++\";\r\n\t\t\t\t} else if(l_code == 10){\r\n\t\t\t\t\tedit.lang2 = \"Java\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcodingService.setLanguage(l_code);\r\n\r\n\t\t\t\t$scope.rooms.$save(edit).then(function(){\r\n\t\t\t\t\tconsole.log(\"player2 is ready\");\t\t\t\t\r\n\t\t\t\t});\r\n\t\t\t}else{\r\n\t\t\t\talert(\"you cannot set language from other player.\")\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t$scope.test = function(){\r\n\t\t\tuserModel.getPlayerDetails(1, 3, 1) \r\n\t\t\t\t\t.success(function(response){\r\n\t\t\t\t\t\tconsole.log(response);\r\n\t\t\t\t\t});\r\n\t\t}\r\n\r\n\t  \t$scope.addMessage = function() {\r\n\t\t    $scope.messages.$add({\r\n\t\t      text: $scope.newMessageText\r\n\t\t    });\r\n\t  \t}\r\n\r\n\t  \tvar is_able = true;\r\n\r\n\t  \t$scope.$on('$stateChangeStart', function( event ) {\r\n\t  \t\tis_able = false;\t\r\n\t\t    \r\n\t\t    if(!leaveState){\r\n\t\t\t    if(roomKey){\r\n\t\t\t\t\t$scope.rooms.$remove($scope.rooms.$indexFor(roomKey))\r\n\t\t\t\t\t.then(function(ref){\r\n\t\t\t\t\t\tconsole.log(\"Room was deleted\");\r\n\t\t\t\t\t});\r\n\t  \t\t\t}\r\n\t\t    }\r\n\t\t});\r\n\r\n\t\twindow.onbeforeunload = function() { \r\n\t  \t\tif(is_able){\r\n\t\t\t      if(confirm('are you sure to exit?')) {\r\n           \t\t\treturn true; \r\n\t\t\t      }\r\n\t\t\t      else {\r\n\t\t\t        return false; \r\n\t\t\t      }\r\n\t\t  \t}\r\n\t\t};\t  \t\t\r\n\r\n\t\t$(window).on('unload', function(e) {\r\n  \t\t\tif(roomKey){\r\n\t\t\t\t$scope.rooms.$remove($scope.rooms.$indexFor(roomKey))\r\n\t\t\t\t.then(function(ref){\r\n\t\t\t\t\tconsole.log(\"Room was deleted\");\r\n\t\t\t\t});\r\n  \t\t\t}\r\n\t\t});\r\n\t\t\r\n}]); \r\n\r\n/*\r\n\tRoom status\r\n\t\t0 = waiting for player2\r\n\t\t1 = waiting for player1 respond\r\n\t\t2 = game has started\r\n\t\t3 = game finished\r\n\r\n\r\n*/","myApp.controller('globalController', ['$scope', 'userModel', 'problemModel', 'rankService',\r\n\tfunction($scope, userModel, problemModel, rankService){\r\n\r\n\t\tangular.extend($scope,{\r\n\t\t\trankSCS: null,\r\n\t\t\trankRCS: null,\r\n\t\t\trankARR: null\r\n\t\t});\r\n\t\t\r\n\t\tangular.extend($scope,{\r\n\t\t\tsetRank: function(){\r\n\t\t\t\tproblemModel.getWeaknessRank(1)\r\n\t\t\t\t\t.success(function(response){\r\n\t\t\t\t\t\t$scope.rankSCS = response[0];\r\n\t\t\t\t\t\t$scope.rankRCS = response[1];\r\n\t\t\t\t\t\t$scope.rankARR = response[2];\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\trankService.setRankSCS(response[0]);\r\n\t\t\t\t\t\trankService.setRankRCS(response[1]);\r\n\t\t\t\t\t\trankService.setRankARR(response[2]);\r\n\r\n\t\t\t\t\t\tconsole.log($scope.rankSCS + \" \" + $scope.rankRCS + \" \" + $scope.rankARR);\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tuserModel.checkAuth()\r\n\t\t\t.success(function(response){\r\n\t\t\t\tif(response == 1){\r\n\t\t\t\t\t$scope.setRank();\t\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t}]);\r\n","myApp.controller('userController', ['$scope', \r\n\tfunction($scope){\r\n\t\t//function\r\n\t\tangular.extend($scope, {\r\n\t\t\ttestFunction: function(){\r\n\t\t\t\talert('Yeah');\r\n\t\t\t},\r\n\r\n\t\t});\r\n\r\n\t}]);","myApp.controller('navController', ['$scope', '$rootScope',\r\n\tfunction($scope, $rootScope){\r\n\r\n\t\t$rootScope.$on(\"GlobalToggleSidebar\", function(){\r\n           $scope.hideSidebar();\r\n        });\r\n\r\n\t\t// variables\r\n\t\tangular.extend($scope, {\r\n\t\t\tshowNav: true\r\n\t\t}); \r\n\t\t\r\n\t\t// functions\r\n\t\tangular.extend($scope, {\r\n\r\n\t\t\ttoggleSidebar: function(){\r\n\t\t\t\tconsole.log('toggled');\r\n\t\t\t\tvar sidebar = $(\"#sidebar-wrapper\");\r\n\t\t\t\tvar content = $(\"#page-content-wrapper\");\r\n\t\t\t\tif(sidebar.hasClass(\"open\")){\r\n\t\t\t\t\tsidebar.css('-webkit-transform', 'translate(-98%,0');\r\n\t\t\t\t\tcontent.css('padding-left', \"0%\");\r\n\t\t\t\t}else{\r\n\t\t\t\t\tsidebar.css('-webkit-transform', 'translate(0,0');\t\r\n\t\t\t\t\tcontent.css('padding-left', \"260px\");\r\n\t\t\t\t}\r\n\t\t\t\tsidebar.toggleClass(\"open\");\r\n\t\t\t},\r\n\t\t\thideSidebar: function(){\r\n\t\t\t\t\r\n\t\t\t\tvar sidebar = $(\"#sidebar-wrapper\");\r\n\t\t\t\tvar content = $(\"#page-content-wrapper\");\r\n\r\n\t\t\t\tsidebar.css('-webkit-transform', 'translate(-98%,0');\r\n\t\t\t\tcontent.css('padding-left', \"0%\");\r\n\t\t\t},\r\n\t\t\t\r\n\t\t});\r\n\t}]);\r\n","myApp.controller('codeController', ['$scope','$rootScope', \r\n\t\t'codeModel', 'problemModel', 'codingService', '$state',\r\n\t\t'errorService', 'rankService', 'userModel', '$firebaseArray',\r\n\tfunction($scope,$rootScope, codeModel, problemModel, codingService,\r\n\t\t$state, errorService, rankService, userModel, $firebaseArray){\r\n\r\n\t\t// global variables\r\n\t\tvar g_languageId = null,\r\n\t\t\tg_statusId = null,\r\n\t\t\tg_submitId = null,\r\n\t\t\tg_array_errors = [],\r\n\t\t\tround = 0, \r\n\t\t\troomKey = null,\r\n\t\t\tuserId = 0,\r\n\t\t\tleaveState = false,\r\n\t\t\tisLose = false,\r\n\t\t\thasNewWeakness = false,\r\n\t\t\twrongAnswer = 0,\r\n\t\t\trank1 = 0,\r\n\t\t\trank2 = 0,\r\n\t\t\trank3 = 0;\r\n\r\n\t\t// scoped variables\r\n\t\tangular.extend($scope, {\r\n\t\t\tnewCode: {\r\n\t\t\t\tcodes: null,\r\n\t\t\t\tinput: null\r\n\t\t\t}, \r\n\t\t\terror: null,\r\n\t\t\tshowOutput: false,\r\n\t\t\tshowProblem: true,\r\n\t\t\tcompiling: true,\r\n\t\t\tresult: null,\r\n\t\t\tresultValue: null,\r\n\t\t\ttime: null,\r\n\t\t\tmemory: null,\r\n\t\t\tsignal: null,\r\n\r\n\t\t\tproblemCode: null,\r\n\t\t\tproblemTitle: null,\r\n\t\t\tproblemDescription: null,\r\n\t\t\tisCorrect : false,\r\n\t\t\t\r\n\t\t\tsubmitCodeId: null,\r\n\t\t\tsubmitStatusDescription: null,\r\n\t\t\tcheckingResult: false,\r\n\t\t\tresultSubmissionColor: null,\r\n\t\t\t\r\n\t\t\tisMultiplayer:false,\r\n\t\t\t\r\n\t\t\t// temporary\r\n\t\t\terrors: {\r\n\t\t\t\tms: 0,\r\n\t\t\t\tse: 0,\r\n\t\t\t\tpm: 0,\r\n\t\t\t\tee: 0,\r\n\t\t\t\tre: 0\t\t\t\t\r\n\t\t\t}\r\n\t\t}); \t\r\n\r\n\t\t \r\n\t\t// functions\r\n\t\tangular.extend($scope, {\r\n\t\t\t/* Results value or details */\r\n\t\t\tgetResultValue: function(id){\r\n\t\t\t\tswitch(id){\r\n\t\t\t\t\tcase 11: \r\n\t\t\t\t\t\treturn \"Compilation Error\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 12:\r\n\t\t\t\t\t\treturn \"Runtime Error\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 13:\r\n\t\t\t\t\t\treturn \"Time limit Exceeded\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 15: \r\n\t\t\t\t\t\treturn \"Success\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 17: \r\n\t\t\t\t\t\treturn \"Memory Limit Exceeded\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 19:\r\n\t\t\t\t\t\treturn \"Illegal System Call\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 20:\r\n\t\t\t\t\t\treturn \"Internal Error\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault: \r\n\t\t\t\t\t\treturn 0;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t/* Getting Submission Status will loop until status_id is = 0*/\r\n\t\t\tgetSubmissionStatus: function(id){\t\t\t\t\r\n\t\t\t\t$('.nav-tabs a[href=\"#output\"]').tab('show');\r\n\t\t\t\t/* request to API the status of submission */\r\n\t\t\t\tcodeModel.submissionStatusModel(id).then(function(response){\r\n\t\t\t\t\t$scope.output = \"\";\r\n\t\t\t\t\t$scope.error = \"\";\r\n\r\n\t\t\t\t\t$scope.showOutput = true;\r\n\t\t\t\t\tconsole.log(response);\r\n\t\t\t\t\t$scope.showProblem = true;\r\n\t\t\t\t\tvar status_id = response.status;\r\n\t\t\t\t\tconsole.log(status_id);\r\n\r\n\t\t  \t\t\tif(status_id != 0){\r\n\t\t  \t\t\t\t$scope.compiling = true;\r\n\t\t  \t\t\t\tif(status_id < 0)\r\n\t\t  \t\t\t\t\t$scope.status = \"Waiting for compilation...\";\r\n\t\t  \t\t\t\telse if(status_id == 1)\r\n\t\t  \t\t\t\t\t$scope.status = \"Compilation...\";\r\n\t\t  \t\t\t\telse if(status_id == 3)\r\n\t\t  \t\t\t\t\t$scope.status = \"Running...\";\r\n\t\t  \t\t\t\t$scope.getSubmissionStatus(g_submitId);\r\n\t\t  \t\t\t}else{\r\n\t\t  \t\t\t\t$scope.status = \"\";\r\n\t\t  \t\t\t\t$scope.compiling = false;\r\n\t\t  \t\t\t\t\r\n\t\t  \t\t\t\t$scope.time = response.time;\r\n\t\t  \t\t\t\t$scope.memory = response.memory;\r\n\t\t  \t\t\t\t$scope.signal - response.signal;\r\n\t\t  \t\t\t}\r\n\r\n\t\t  \t\t\t$scope.resultValue = $scope.getResultValue(response.result);\r\n\t\t  \t\t\tconsole.log(response.result);\r\n\t\t  \t\t\tconsole.log($scope.getResultValue(response.result));\r\n\t  \t\t\t\t\r\n\t\t  \t\t\tif(response.result == 15){\r\n\t\t  \t\t\t\t$scope.resultValueColor = \"resultValSuccess\";\r\n\t\t  \t\t\t\t$scope.output = response.output;\r\n\t\t  \t\t\t}else if(response.result == 12){\r\n\t\t  \t\t\t\t$scope.resultValueColor = \"resultValError\";\r\n\t\t  \t\t\t}else if(response.result == 11){\r\n\t\t  \t\t\t\t$scope.resultValueColor = \"resultValError\";\r\n\t\t  \t\t\t\t$scope.error = response.cmpinfo;\r\n\r\n\t\t  \t\t\t\tswitch(g_languageId){\r\n\t\t\t\t\t\t\tcase 1: //C++\r\n\t\t\t\t\t\t\t\tg_array_errors = $scope.error.split(\"prog.cpp:\");\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 11: // C\r\n\t\t\t\t\t\t\t\tg_array_errors = $scope.error.split(\"prog.c:\");\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 10: // Java\r\n\t\t\t\t\t\t\t\tg_array_errors = $scope.error.split(\"Main.java:\");\r\n\t\t\t\t\t\t\t\tbreak; \r\n\t\t\t\t\t\t}\r\n\r\n\t\t  \t\t\t\terrorService.setErrors(g_array_errors);\r\n\t\t  \t\t\t\t\r\n\t\t  \t\t\t\t$scope.getErrorsMS();\r\n\t\t\t\t\t\t$scope.getErrorsSE();\r\n\t\t\t\t\t\t$scope.getErrorsPM();\r\n\t\t\t\t\t\t$scope.getErrorsIE();\r\n\r\n\r\n\t\t\t\t\t\t// temporary display error counts\r\n\t\t\t\t\t\t$scope.errors.ms = errorService.getErrorCountMS();\r\n\t\t\t\t\t\t$scope.errors.se = errorService.getErrorCountSE();\r\n\t\t\t\t\t\t$scope.errors.pm = errorService.getErrorCountPM();\r\n\t\t\t\t\t\t$scope.errors.ee = errorService.getErrorCountIE();\r\n\t\t  \t\t\t}else{\r\n\t\t  \t\t\t\t$scope.resultValueColor = \"resultValError\";\r\n\t\t  \t\t\t}\r\n\t  \t\t\t\r\n\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\trunCode: function(editorForm){\r\n\t\t\t\tvar editor = ace.edit(\"editor\");\r\n\t\t\t\tvar code = editor.getValue();\r\n\t\t\t\tconsole.log(\"code \" + code);\r\n\t\t\t\t\r\n\t\t\t\t/* Submit the code to API and get its status */\r\n\t\t\t\t$.ajax({\r\n\t\t\t\t  \ttype: \"POST\",\r\n\t\t\t\t  \turl: 'http://db4262da.compilers.sphere-engine.com/api/v3/submissions?access_token=00c04ffac4d4ffe13d590b91b70ef3f2',\r\n\t\t\t\t  \tdata: \r\n\t\t\t\t  \t\t{\r\n\t\t\t\t \t\tsourceCode: code,\r\n\t\t\t\t \t\tlanguage: g_languageId,\r\n\t\t\t\t \t\tinput: $scope.newCode.input\r\n\t\t\t\t \t},\r\n\t\t\t\t  \tsuccess: function(result, data){\r\n\t\t\t\t  \t\tvar obj = JSON.parse(result);\r\n\t\t\t\t\t  \tg_submitId = obj.id;\r\n\t\t\t\t  \t\tconsole.log(obj.id);\r\n\t\t  \t\t\t\t$scope.getSubmissionStatus(g_submitId);\r\n\t\t\t\t  \t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\ttestError: function(){\t\t\t\r\n\t\t\t\t$scope.getSubmissionStatus(47872263);\r\n\t\t\t},\r\n\t\t\ttestSuccess: function(){\r\n\t\t\t\t$scope.getSubmissionStatus(47900843);\r\n\t\t\t},\r\n\t\t\ttesting1: function(){\r\n\t\t\t\t$scope.getSubmissionStatus(48791363);\r\n\t\t\t},\r\n\t\t\ttesting2: function(){\r\n\t\t\t\t$scope.getSubmissionStatus(48791371);\r\n\t\t\t},\r\n\t\t\ttesting3: function(){\r\n\t\t\t\t$scope.getSubmissionStatus(47900843);\r\n\t\t\t},\r\n\t\t\tgetErrorsMS: function(){\r\n\t\t\t\tvar array_error = g_array_errors;\r\n\t\t\t\tvar number_of_errors = 0;\r\n\t\t\t\tswitch(g_languageId){\r\n\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\tfor(i = 0; i < array_error.length; i ++){\r\n\t\t\t\t\t\t\tvar str = array_error[i];\r\n\t\t\t\t\t\t\t\tif(str.includes(\"expected ';' before\")){\r\n\t\t\t\t\t\t\t\t\tnumber_of_errors ++;\r\n\t\t\t\t\t\t\t\t} \r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\terrorService.addErrorCountMS(number_of_errors);\t\t \r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 10:\r\n\r\n\t\t\t\t\t\t// ';' expected\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 11:\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\tgetErrorsSE: function(){\r\n\t\t\t\t\r\n\t\t\t\tvar array_error = g_array_errors;\r\n\t\t\t\tvar number_of_errors = 0;\r\n\r\n\t\t\t\tswitch(g_languageId){\r\n\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\tfor(i = 0; i < array_error.length; i ++){\r\n\t\t\t\t\t\t\tvar str = array_error[i];\r\n\t\t\t\t\t\t\tif(str.includes(\"was not declared in this scope\")){\r\n\t\t\t\t\t\t\t\tnumber_of_errors ++;\r\n\t\t\t\t\t\t\t} \r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\terrorService.addErrorCountSE(number_of_errors);\t\t \r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 10:\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 11:\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetErrorsPM: function(){\r\n\t\t\t\tvar array_error = g_array_errors;\r\n\t\t\t\tvar number_of_errors = 0;\r\n\r\n\t\t\t\tswitch(g_languageId){\r\n\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\tfor(i = 0; i < array_error.length; i++){\r\n\t\t\t\t\t\t\tvar str = array_error[i];\r\n\t\t\t\t\t\t\tif(str.includes(\"expected ')'\")){\r\n\t\t\t\t\t\t\t\tnumber_of_errors ++;\r\n\t\t\t\t\t\t\t} else if(str.includes(\"expected ']'\")){\r\n\t\t\t\t\t\t\t\tnumber_of_errors ++;\r\n\t\t\t\t\t\t\t} else if(str.includes(\"expected '}'\")){\r\n\t\t\t\t\t\t\t\tnumber_of_errors ++;\r\n\t\t\t\t\t\t\t} else if(str.includes(\"expected '('\")){\r\n\t\t\t\t\t\t\t\tnumber_of_errors ++;\r\n\t\t\t\t\t\t\t} else if(str.includes(\"expected '{'\")){\r\n\t\t\t\t\t\t\t\tnumber_of_errors ++;\r\n\t\t\t\t\t\t\t}else if(str.includes(\"expected '['\")){\r\n\t\t\t\t\t\t\t\tnumber_of_errors ++;\r\n\t\t\t\t\t\t\t} \r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\terrorService.addErrorCountPM(number_of_errors);\t\t \r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 10:\r\n\t\t\t\t\t\tfor(i = 0; i < array_error.length; i++){\r\n\t\t\t\t\t\t\tvar str = array_error[i];\r\n\t\t\t\t\t\t\tif(str.includes(\"expected ')'\")){\r\n\t\t\t\t\t\t\t\tnumber_of_errors ++;\r\n\t\t\t\t\t\t\t} else if(str.includes(\"expected ']'\")){\r\n\t\t\t\t\t\t\t\tnumber_of_errors ++;\r\n\t\t\t\t\t\t\t} else if(str.includes(\"expected '}'\")){\r\n\t\t\t\t\t\t\t\tnumber_of_errors ++;\r\n\t\t\t\t\t\t\t} else if(str.includes(\"expected '('\")){\r\n\t\t\t\t\t\t\t\tnumber_of_errors ++;\r\n\t\t\t\t\t\t\t} else if(str.includes(\"expected '{'\")){\r\n\t\t\t\t\t\t\t\tnumber_of_errors ++;\r\n\t\t\t\t\t\t\t}else if(str.includes(\"expected '['\")){\r\n\t\t\t\t\t\t\t\tnumber_of_errors ++;\r\n\t\t\t\t\t\t\t} \t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 11:\r\n\t\t\t\t}\t\t\t\t\t\r\n\t\t\t},\r\n\t\t\tgetErrorsIE: function(){\r\n\t\t\t\tvar array_error = g_array_errors;\r\n\t\t\t\tvar number_of_errors = 0;\r\n\t\t\t\tswitch(g_languageId){\r\n\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\tfor(i = 0; i < array_error.length; i ++){\r\n\t\t\t\t\t\t\tvar str = array_error[i];\r\n\t\t\t\t\t\t\t\tif(str.includes(\"expected initializer\")){\r\n\t\t\t\t\t\t\t\t\tnumber_of_errors ++;\r\n\t\t\t\t\t\t\t\t} \r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\terrorService.addErrorCountIE(number_of_errors);\t\t \r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 10:\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 11:\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tSubmitCode: function(){\r\n\t\t\t\tvar problemCode = $scope.problemCode;\r\n\t\t\t\tvar editor = ace.edit(\"editor\");\r\n\t\t\t\tvar code = editor.getValue();\r\n\t\t\t\tconsole.log(problemCode);\r\n\t\t\t\tvar codeData = {\r\n\t\t\t\t\tproblemCode: problemCode,\r\n\t\t\t\t\tcompilerId: g_languageId,\r\n\t\t\t\t\tsource: code\r\n\t\t\t\t}\r\n\t\t\t\tvar submissionId;\r\n\r\n\t\t\t\tproblemModel.getSubmissionId(codeData)\r\n\t\t\t\t\t.then(function(response){\r\n\t\t\t\t\t\t$scope.checkingResult = false;\r\n\t\t\t\t\t\t$scope.submitCodeId = response.data.submissionId;\r\n\t\t\t\t\t\t$scope.resultSubmissionColor = \"submission-running\";\r\n\t\t\t\t\t\t$scope.submitStatusDescription = \"\";\r\n\t\t\t\t\t\t$scope.testGetProblemDetails();\r\n\t\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tcheckRankForWeakness: function(w){\r\n\t\t\t\tswitch(w){\r\n\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\tif(rank1 >= 10){\r\n\t\t\t\t\t\t\tif(rank2 <= 10 || rank3 <= 10){\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else if(rank1 >= 25){\r\n\t\t\t\t\t\t\tif(rank2 <= 25 || rank3 <= 25){\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tif(rank2 <= 40 || rank3 <= 40){\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\tif(rank2 >= 10){\r\n\t\t\t\t\t\t\tif(rank1 <= 10 || rank3 <= 10){\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else if(rank2 >= 25){\r\n\t\t\t\t\t\t\tif(rank1 <= 25 || rank3 <= 25){\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tif(rank1 <= 40 || rank3 <= 40){\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\tif(rank3 >= 10){\r\n\t\t\t\t\t\t\tif(rank1 <= 10 || rank2 <= 10){\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else if(rank3 >= 25){\r\n\t\t\t\t\t\t\tif(rank1 <= 25 || rank2 <= 25){\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tif(rank1 <= 40 || rank2 <= 40){\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t},\r\n\t\t\ttestGetProblemDetails: function(){\r\n\t\t\t\t$('#myModal').modal({ keyboard: false, backdrop: false, show: true })\r\n\t\t\t\tproblemModel.getSubmissionDetails($scope.submitCodeId)\r\n\t\t\t\t\t.success(function(response){\r\n\t\t\t\t\t\tconsole.log(response);\r\n\t\t\t\t\t\tvar status_id = response.status;\r\n\t\t\t\t\t\t$scope.submitStatusDescription = response.statusDescription;\r\n\t\t\t\t\t\tif(status_id < 9){\r\n\t\t\t\t\t\t\t$scope.testGetProblemDetails();\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t$scope.checkingResult = true;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif(status_id == 15){\r\n\t\t\t\t\t\t\t\t/* code accepted */\r\n\t\t\t\t\t\t\t\t$scope.isCorrect = true;\r\n\t\t\t\t\t\t\t\t$scope.resultSubmissionColor = \"submission-accepted\";\r\n\t\t\t\t\t\t\t\t$scope.submitStatusDescription = \"Accepted!\";\r\n\t\t\t\t\t\t\t\tcodingService.setSuccess(true);\r\n\t\t\t\t\t\t\t\tcodeModel.setRound(round)\r\n\t\t\t\t\t\t\t\t\t.success(function(){\r\n\t\t\t\t\t\t\t\t\t\tconsole.log('problem set to solve');\r\n\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t/* set to no weakness */\r\n\t\t\t\t\t\t\t\tif( !hasNewWeakness || checkRankForWeakness(weakness) ){\r\n\t\t\t\t\t\t\t\t\tproblemModel.setWeakness(0);\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif($scope.isMultiplayer){\r\n\t\t\t\t\t\t\t\t\tvar r = $scope.rooms.$getRecord(roomKey);\r\n\t\t\t\t\t\t\t\t\tvar opponent;\t\r\n\t\t\t\t\t\t\t\t\tif(r.player1 == userId){\r\n\t\t\t\t\t\t\t\t\t\topponent = r.player2;\r\n\t\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\t\topponent = r.player1;\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tif(!isLose){\r\n\t\t\t\t\t\t\t\t\t\t$scope.winOrLoseMessage = \"You won against player \" + opponent;\r\n\t\t\t\t\t\t\t\t\t\tr.winner = userId;\r\n\t\t\t\t\t\t\t\t\t\t$scope.rooms.$save(r);\r\n\t\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\t\t$scope.winOrLoseMessage = \"You lose against player \" + opponent;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\twrongAnswer++;\r\n\t\t\t\t\t\t\t\tif(wrongAnswer == 3){\r\n\t\t\t\t\t\t\t\t\tproblemModel.setWeakness(codingService.getWeaknessId())\r\n\t\t\t\t\t\t\t\t\t.success(function(){\r\n\t\t\t\t\t\t\t\t\t\thasNewWeakness = true;\r\n\t\t\t\t\t\t\t\t\t\tconsole.log(\"weakness set to \" + codingService.getWeaknessId());\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t$scope.resultSubmissionColor = \"submission-error\";\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tgetSkeletonCode: function(problem_code, language_id){\r\n\t\t\t\tproblemModel.getSkeletonCode(problem_code, language_id) \r\n\t\t\t\t\t.success(function(response){\r\n\t\t\t\t\t\tconsole.log(response);\r\n\t\t\t\t\t\t$scope.newCode.codes = response;\r\n\t\t\t\t\t\tvar sc = $scope.newCode.codes;\r\n\t\t\t\t\t    var editor = ace.edit(\"editor\");\r\n\t\t\t\t\t    editor.setTheme(\"ace/theme/monokai\");\r\n\t\t\t\t\t    editor.getSession().setValue(sc);\r\n\t\t\t\t\t    editor.resize();\r\n\t\t\t\t\t});\r\n\t\t\t},\t\t\t\r\n\t\t\tupdateRankProceed: function(){\r\n\t\t\t\t\r\n\t\t\t\t$scope.setRank();\r\n\t\t\t\tleaveState = true;\r\n\t\t\t\t$state.go('resultPage');\r\n\t\t\t},\r\n\t\t\tproceed: function(){\r\n\t\t\t\t/* set error counts in each subj from this round */\r\n\t\t\t\tcodeModel.saveErrors(errorService.getErrorCountMS(), errorService.getErrorCountSE(),\r\n\t\t\t\t\terrorService.getErrorCountPM(), errorService.getErrorCountIE(), \"single\" )\r\n\t\t\t\t.success(function(){\r\n\t\t\t\t\tconsole.log(\"Error counts are set.\");\r\n\t\t\t\t});\r\n\r\n\t\t\t\tvar weakness = codingService.getWeaknessId();\r\n\t\t\t\tif($scope.isCorrect){\r\n\t\t\t\t\tcodeModel.rankUp(weakness)\r\n\t\t\t\t\t\t.success(function(response){\r\n\t\t\t\t\t\t\tcodingService.setIsEnableCode(false);\r\n\t\t\t\t\t\t\t$scope.updateRankProceed();\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.error(function(){\r\n\t\t\t\t\t\t\t$scope.proceed();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcodingService.setIsEnableCode(false);\r\n\t\t\t\t\tcodingService.setSuccess(false);\r\n\t\t\t\t\tproblemModel.setWeakness(weakness)\r\n\t\t\t\t\t.success(function(){\r\n\t\t\t\t\t\t$scope.updateRankProceed();\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\t// automatic activity\r\n\t\trank1 = rankService.getRankSCS();\r\n\t\trank2 = rankService.getRankRCS();\r\n\t\trank3 = rankService.getRankARR();\r\n\r\n\t\tif(codingService.getIsEnableCode()){\r\n\t\t\t// get problem details\r\n\t\t\tcodingService.setSuccess(false);\r\n\t\t\tvar pCode = codingService.getProblemCode();\r\n\t\t\tvar langId = codingService.getLanguage();\r\n\t\t\t// set problem details\r\n\t\t\t$scope.problemCode = pCode;\r\n\t\t\tg_languageId = langId;\r\n\t\t\tconsole.log(pCode);\r\n\t\t\tcodeModel.addRound(pCode)\r\n\t\t\t\t.success(function (response){\r\n\t\t\t\t\t// round ID\r\n\t\t\t\t\tround = response;\r\n\t\t\t\t\tconsole.log(response);\r\n\t\t\t\t});\r\n\r\n\t\t\tproblemModel.getProblem($scope.problemCode)\r\n\t\t\t\t.success(function(response){\t\t\r\n\t\t\t\t\t$rootScope.$emit(\"GlobalToggleSidebar\", {});\r\n\r\n\t\t\t\t\t$('.nav-tabs a[href=\"#problem_details\"]').tab('show');\r\n\r\n\t\t\t\t\t$scope.problemTitle = response.name;\r\n\t\t\t\t\t$scope.problemDescription = response.body;\r\n\t\t\t\t\t$scope.getSkeletonCode($scope.problemCode, g_languageId);\r\n\t\t\t\t})\r\n\t\t\t\t.error(function(result){\r\n\t\t\t\t\tconsole.log(result);\r\n\t\t\t\t});\r\n\r\n\t\t\tfunction startTimer(duration,display) {\r\n\t\t\t    var timer = duration, minutes, seconds;\r\n\t\t\t    var timerId = setInterval(function () {\r\n\t\t\t        hours = parseInt((timer / 60) / 60, 10);\r\n\t\t\t        minutes = parseInt((timer / 60) % 60, 10);\r\n\t\t\t        seconds = parseInt(timer % 60, 10);\r\n\r\n\t\t\t        hours = hours < 10 ? \"0\" + hours : hours;\r\n\t\t\t        minutes = minutes < 10 ? \"0\" + minutes : minutes;\r\n\t\t\t        seconds = seconds < 10 ? \"0\" + seconds : seconds;\r\n\r\n\t\t\t        display.textContent = hours + \":\" + minutes + \":\" + seconds;\r\n\r\n\t\t\t        if (--timer < 0) {\r\n\t\t\t            clearInterval(timerId);\r\n\t\t\t            $('#myTimeUpModal').modal({ keyboard: false, backdrop: false, show: true })\r\n\t\t\t            console.log(\"Time's Up!!!\");\r\n\t\t\t        }\r\n\t\t\t    }, 1000);\r\n\t\t\t}\r\n\t\t\tdisplay = document.querySelector('#time');\r\n\t\t    var timeLimit = codingService.getTimeLimit();\r\n\t\t    startTimer(timeLimit, display);\r\n\t\t}else{\r\n\t\t\tleaveState = true;\r\n\t\t\t$state.go('problemPage');\r\n\t\t\tconsole.log('unable to code');\r\n\t\t}\t\r\n\r\n\t\t/* Get user id */\r\n\t    userModel.getUserId()\r\n\t\t\t.success(function(response){\r\n\t\t\t\tuserId = response;\r\n\t\t\t\t/* check if multiplayer */\r\n\t\t\t\tif(codingService.getIsMultiplayer()){\r\n\t\t\t    \t$scope.isMultiplayer = true;\r\n\r\n\t\t\t\t\tvar refRoom = firebase.database().ref().child(\"rooms\");\r\n\t\t\t\t\t$scope.rooms = $firebaseArray(refRoom);\r\n\t\t\t\r\n\t\t\t    \troomKey = codingService.getRoomKey();\r\n\r\n\t\t\t    \t$scope.rooms.$loaded() \r\n\t\t\t    \t\t.then(function(room){\r\n\t\t\t    \t\t\tcheckWinner();\r\n\t\t\t    \t\t});\r\n\r\n\t\t\t    }\r\n\t\t\t});\r\n\r\n\t    function checkWinner(){\r\n\t    \tvar r = $scope.rooms.$getRecord(roomKey);\r\n\t  \t\tif(!r.winner){\r\n\t  \t\t\tsetTimeout(checkWinner, 1000);\r\n\t  \t\t\treturn;\r\n\t  \t\t}\r\n\r\n  \t\t\tif(r.winner != userId){\r\n  \t\t\t\tisLose = true;\r\n  \t\t\t\talert(r.winner + \" has won the game!\");\r\n  \t\t\t}\r\n\t  \t\treturn;\r\n\t    }\r\n\r\n\t    /* functions when user leaves the page */\r\n\t\tvar is_able_c = true;\r\n\r\n\t  \t$scope.$on('$stateChangeStart', function( event ) {\r\n\t  \t\tis_able_c = false;\t\r\n\t\t    \r\n\t\t    if(!leaveState){\r\n\t    \t\tif(confirm('Are you sure you want to leave? this will be considere that you have given up the problem.')) {           \t\t\t\r\n           \t\t\tcodingService.setIsEnableCode(false);\r\n\t\t\t    } else {\r\n\t\t\t    \tis_able_c = true;\r\n\t\t\t   \t\tevent.preventDefault();\r\n\t\t\t    }\r\n\t\t    }\r\n\t\t});\r\n\r\n\t\twindow.onbeforeunload = function() { \r\n\t  \t\tif(is_able_c){\r\n\t\t\t      if(confirm('Are you sure you want to leave? this will be considere that you have given up the problem.')) {\r\n\t\t\t      \tcodingService.setIsEnableCode(false);\r\n           \t\t\treturn true; \r\n\t\t\t      }\r\n\t\t\t      else {\r\n\t\t\t        return false; \r\n\t\t\t      }\r\n\t\t  \t}\r\n\t\t};\t  \t\t\r\n\r\n\t\t$(window).on('unload', function(e) {\r\n\t\t\tconsole.log(\"You have given up\");\r\n\t\t});\r\n\r\n\r\n\t}]);","myApp.controller('problemController', ['$scope','problemModel', '$state', 'codingService', 'rankService',\r\n\tfunction($scope, problemModel, $state,codingService,rankService){\r\n\r\n\t\tvar weaknesses = [];\r\n\t\tvar problem_code = null;\r\n\r\n\t\t// variables\r\n\t\tangular.extend($scope, {\r\n\t\t\tlanguage: \"C\",\r\n\t\t\tlanguageId: 11,\r\n\t\t\tloadingProblem: true,\r\n\t\t\tloadSuccess: false,\r\n\t\t\thasWeakness: false\r\n\t\t});\r\n\r\n\t\t// functions\r\n\t\tangular.extend($scope,{\r\n\t\t\tgetProblemCode: function(){\r\n\t\t\t},\r\n\t\t\tgetProblem: function(){\r\n\t\t\t\t/* From Shere Engine API */\r\n\t\t\t\tproblemModel.getProblem(problem_code)\r\n\t\t\t\t\t.success(function(response){\r\n\t\t\t\t\t\t$scope.loadingProblem = false;\r\n\t\t\t\t\t\t$scope.problemTitle = response.name;\r\n\t\t\t\t\t\t$scope.problemDescription = response.body;\r\n\t\t\t\t\t})\r\n\t\t\t\t\t. error(function(response){\r\n\t\t\t\t\t\t$scope.loadingProblem = false;\r\n\t\t\t\t\t\t$scope.problemTitle = \"Failed to load problem. Please Try Again\";\r\n\t\t\t\t\t});\r\n\t\t\t\t/* From My API */\r\n\t\t\t\tproblemModel.getProblemDetails(problem_code)\r\n\t\t\t\t\t.success(function(response){\r\n\t\t\t\t\t\tcodingService.setTimeLimit(response.time_limit);\r\n\t\t\t\t\t\tvar time = response.time_limit;\r\n\t\t\t\t\t\tvar hr = parseInt((time / 60) / 60, 10);\r\n\t\t\t\t\t\tvar min = parseInt((time / 60) % 60, 10);\r\n\t\t\t\t\t\tvar sec = parseInt(time % 60, 10);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t$scope.loadSuccess = true;\r\n\t\t\t\t\t\t$scope.difficulty = response.difficulty;\r\n\t\t\t\t\t\t$scope.time_limit = hr + \"hr/s and \" + min + \"min/s\"\r\n\r\n\t\t\t\t\t\tswitch(response.weakness_id){\r\n\t\t\t\t\t\t\tcase 1: \r\n\t\t\t\t\t\t\t\t$scope.subject_area = \"Selection Control Structure\";\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 2: \r\n\t\t\t\t\t\t\t$scope.subject_area = \"Repetition Control Structure\";\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 3: \r\n\t\t\t\t\t\t\t$scope.subject_area = \"Array\";\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.error(function(response){\r\n\t\t\t\t\t\t$scope.loadingProblem = false;\r\n\t\t\t\t\t\t$scope.problemTitle = \"Failed to load problem. Please Try Again\";\r\n\t\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tsolveIt: function(){\r\n\t\t\t\tconsole.log(problem_code);\r\n\t\t\t\tconsole.log($scope.languageId);\r\n\t\t\t\tcodingService.setProblemCode(problem_code);\r\n\t\t\t\tcodingService.setIsEnableCode(true);\r\n\t\t\t\tcodingService.setIsMultiplayer(false);\r\n\t\t\t\t$state.go('codingPage');\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\tgetRandomProblems: function(w){\r\n\t\t\t\tproblemModel.getRandomProblem(w)\r\n\t\t\t\t\t.success(function(response){\r\n\t\t\t\t\t\tconsole.log(response);\r\n\t\t\t\t\t\tif(response != 0){\r\n\t\t\t\t\t\t\tproblem_code = response;\r\n\t\t\t\t\t\t\t$scope.getProblem();\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\talert('There is no more problem to fetch');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\t\r\n\t\t\t\t\t.error(function(){\r\n\t\t\t\t\t\talert('There was an error fetching a problem');\r\n\t\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tgetRandomWeakness: function(){\r\n\t\t\t\tvar included = [];\r\n\t\t\t\tvar prioritize = 4;\r\n\t\t\t\tfor(var x = 0; x < 3; x++){\r\n\t\t\t\t\tvar loop = 0;\r\n\t\t\t\t\tvar lower = 0;\r\n\t\t\t\t\tvar higher = 0;\r\n\t\t\t\t\tif(prioritize == 4){\r\n\t\t\t\t\t\tfor(var y = 0; y < 3 ; y++){\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif( x == y ){\r\n\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tloop ++;\r\n\r\n\t\t\t\t\t\t\tif(Math.abs(weaknesses[x] - weaknesses[y]) >=2 ){\r\n\t\t\t\t\t\t\t\tif(weaknesses[x] > weaknesses[y]){\r\n\t\t\t\t\t\t\t\t\thigher++;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tlower++;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif(lower == 2){\r\n\t\t\t\t\t\t\t\tprioritize = x;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(higher != 2){\r\n\t\t\t\t\t\t\t\tif(loop == 2){\r\n\t\t\t\t\t\t\t\t\tincluded.push(x);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tvar selected;\r\n\t\t\t\tif(prioritize == 4){\r\n\t\t\t\t\tselected = included[Math.floor(Math.random() * included.length)];\r\n\t\t\t\t}else{\r\n\t\t\t\t\tselected = prioritize;\r\n\t\t\t\t}\r\n\t\t\t\tselected ++;\r\n\r\n\t\t\t\tcodingService.setWeaknessId(selected);\r\n\t\t\t\t$scope.getRandomProblems(selected);\r\n\t\t\t},\t\r\n\t\t\tlanguageToC: function(){\r\n\t\t\t\t$scope.language = \"C\";\r\n\t\t\t\t$scope.languageId = 11;\r\n\t\t\t\tcodingService.setLanguage(11);\r\n\t\t\t},\r\n\t\t\tlanguageToCpp: function(){\r\n\t\t\t\t$scope.language = \"C++\";\r\n\t\t\t\t$scope.languageId = 1;\r\n\t\t\t\tcodingService.setLanguage(1);\r\n\t\t\t},\r\n\t\t\tlanguageToJava: function(){\r\n\t\t\t\t$scope.language = \"Java\";\r\n\t\t\t\t$scope.languageId = 10;\r\n\t\t\t\tcodingService.setLanguage(10);\r\n\t\t\t},\r\n\t\t\tsetRanks: function(){\r\n\t\t\t\tconsole.log('here');\r\n\t\t\t\tvar rank1 = 0, rank2 = 0, rank3 = 0;\r\n\t\t\t\tfunction initialize(){\r\n\t\t\t\t\trank1 = rankService.getRankSCS();\r\n\t\t\t\t\trank2 = rankService.getRankRCS();\r\n\t\t\t\t\trank3 = rankService.getRankARR();\r\n\t\t\t\t\tif(rank1 == 0 || rank2 == 0 || rank3 == 0){\r\n\t\t\t\t\t\tsetTimeout(initialize, 1000);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tweaknesses.push(rank1);\r\n\t\t\t\t\t\tweaknesses.push(rank2);\r\n\t\t\t\t\t\tweaknesses.push(rank3);\r\n\t\t\t\t\t\t$scope.getRandomWeakness();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tinitialize();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif(codingService.getIsMultiplayer()){\r\n\r\n\t\t}else{\t\r\n\t\t\tproblemModel.checkHasWeakness()\r\n\t\t\t\t.success(function(response){\r\n\t\t\t\t\tif(response == 0){\r\n\t\t\t\t\t\t$scope.setRanks();\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tconsole.log(\"You have a problem in subject area -> \" + response);\r\n\t\t\t\t\t\tcodingService.setWeaknessId(response);\r\n\t\t\t\t\t\t$scope.getRandomProblems(response);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t}\r\n\r\n\t\t// Activities\r\n\t\t$scope.languageToCpp();\t\r\n\t\t\r\n\r\n\t}]);\r\n","myApp.controller('resultController', ['$scope', 'errorService', 'codingService', 'rankService',\r\n\tfunction($scope, errorService,codingService, rankService){\r\n\t\t{\r\n\t\t\t$scope.isSuccess = codingService.getSuccess();\r\n\t\t\tvar subject_area = codingService.getWeaknessId();\r\n\t\t\t\r\n\t\t\tvar getAction = function(sa){\r\n\t\t\t\tif(subject_area == sa){\r\n\t\t\t\t\tif($scope.isSuccess)\r\n\t\t\t\t\t\treturn \"up\";\r\n\t\t\t\t}\r\n\t\t\t\treturn \"none\";\r\n\t\t\t}\r\n\t\t\tsetTimeout(function(){\r\n\t\t\t\t$scope.$apply(function(){\r\n\t\t\t\t\t$scope.ranks = [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"SubjectArea\": \"Selection Control Structure\",\r\n\t\t\t\t\t\t\t\"Rank\": rankService.getRankSCS(),\r\n\t\t\t\t\t\t\t\"Action\" : getAction(1)\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"SubjectArea\": \"Repetition Control Structure\",\r\n\t\t\t\t\t\t\t\"Rank\": rankService.getRankRCS(),\r\n\t\t\t\t\t\t\t\"Action\" : getAction(2)\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"SubjectArea\": \"Array\",\r\n\t\t\t\t\t\t\t\"Rank\": rankService.getRankARR(),\r\n\t\t\t\t\t\t\t\"Action\" : getAction(3)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]\r\n\t\t\t\t});\r\n\t\t\t}, 2000);\r\n\t\t\t\r\n\t\t\t// bar graph\r\n\r\n\t\t\tvar getBarColor = function(num){\r\n\t\t\t\tif( num > 15){\r\n\t\t\t\t\treturn \"rgba(255, 0, 0, 0.8)\";\r\n\t\t\t\t} else if( num <= 15 && num > 8){\r\n\t\t\t\t\treturn \"rgba(255, 153, 0, 0.8)\"\r\n\t\t\t\t} else{\r\n\t\t\t\t\treturn \"rgba(0, 255, 0, 0.8)\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar ctx = document.getElementById(\"myChart\");\r\n\t\t\t\r\n\t\t\tvar barColor = [];\r\n\t\t\tbarColor.push(getBarColor(errorService.getErrorCountMS()));\r\n\t\t\tbarColor.push(getBarColor(errorService.getErrorCountSE()));\r\n\t\t\tbarColor.push(getBarColor(errorService.getErrorCountPM()));\r\n\t\t\tbarColor.push(getBarColor(errorService.getErrorCountIE()));\t\t\t\r\n\r\n\t\t\tvar myChart = new Chart(ctx, {\r\n\t\t\t    type: 'bar',\r\n\t\t\t    data: {\r\n\t\t\t        labels: [\"Missing Semicolon\", \"Scoping Error\", \"Parenthesis Matching\", \"Identifier Error\"],\r\n\t\t\t        datasets: [{\r\n\t\t\t            label: '# of Errors',\r\n\t\t\t            data: [errorService.getErrorCountMS(), errorService.getErrorCountSE(), \r\n\t\t\t            \t\terrorService.getErrorCountPM(), errorService.getErrorCountIE()],\r\n\t\t\t            backgroundColor: barColor\r\n\t\t\t        }]\r\n\t\t\t    },\r\n\t\t\t    options: {\r\n\t\t\t        scales: {\r\n\t\t\t            yAxes: [{\r\n\t\t\t                ticks: {\r\n\t\t\t                    beginAtZero:true,\r\n\t\t\t                    max: 40\r\n\t\t\t                }\r\n\t\t\t            }]\r\n\t\t\t        },\r\n\t\t\t        responsive: false,\r\n\t\t\t        legend:{\r\n\t\t\t        \tdisplay: false\r\n\t\t\t        },\r\n\t\t\t        title: {\r\n\t\t\t            display: true,\r\n\t\t\t            text: 'Error Frequencies',\r\n\t\t\t            fontSize: 20 \r\n\t\t\t        }\r\n\t\t\t    }\r\n\t\t\t});\r\n\r\n\r\n\r\n\t\t}\r\n\t}]);","myApp.controller('statprogController', ['$scope', 'userModel',\r\n\tfunction($scope, userModel){\r\n\t\t\r\n\t\t\r\n\r\n\t\tangular.extend($scope, {\r\n\t\t\thasProgress_single: false,\r\n\t\t\tnoProgress_single: false,\r\n\t\t\thasProgress_multi: false,\r\n\t\t\tnoProgress_multi: false\r\n\t\t});\r\n\r\n\t\tangular.extend($scope, {\r\n\t\t\tgetData: function(label, data, r, g , b){\r\n\t\t\t\tvar data_object = {\r\n\t\t\t\t\t\t            label: label,\r\n\t\t\t\t\t\t            lineTension: 0.1,\r\n\t\t\t\t\t\t            backgroundColor: \"rgba(\"+ r + \",\" + g + \",\" + b + \",0.1)\",\r\n\t\t\t\t\t\t            borderColor: \"rgba(\"+ r + \",\" + g + \",\" + b + \",1)\",\r\n\t\t\t\t\t\t            borderCapStyle: 'butt',\r\n\t\t\t\t\t\t            borderDash: [],\r\n\t\t\t\t\t\t            borderDashOffset: 0.0,\r\n\t\t\t\t\t\t            borderJoinStyle: 'miter',\r\n\t\t\t\t\t\t            pointBorderColor: \"rgba(\"+ r + \",\" + g + \",\" + b + \",1)\",\r\n\t\t\t\t\t\t            pointBackgroundColor: \"#fff\",\r\n\t\t\t\t\t\t            pointBorderWidth: 1,\r\n\t\t\t\t\t\t            pointHoverRadius: 5,\r\n\t\t\t\t\t\t            pointHoverBackgroundColor: \"rgba(\"+ r + \",\" + g + \",\" + b + \",1)\",\r\n\t\t\t\t\t\t            pointHoverBorderColor: \"rgba(220,220,220,1)\",\r\n\t\t\t\t\t\t            pointHoverBorderWidth: 2,\r\n\t\t\t\t\t\t            pointRadius: 1,\r\n\t\t\t\t\t\t            pointHitRadius: 10,\r\n\t\t\t\t\t\t            data: data,\r\n\t\t\t\t\t\t            spanGaps: false,\r\n\t\t\t\t\t\t        }\r\n\t\t\t\treturn data_object;\r\n\t\t\t},\r\n\t\t\tshowGraph: function(response, mode){\r\n\t\t\t\tif(response != 0){\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(mode == \"single\"){\r\n\t\t\t\t\t\t$scope.hasProgress_single = true;\r\n\t\t\t\t\t\tvar ctx = document.getElementById(\"statistical_progress_single\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\t$scope.hasProgress_multi = true;\r\n\t\t\t\t\t\tvar ctx = document.getElementById(\"statistical_progress_multi\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar errs = response;\r\n\t\t\t\t\tvar lbl_i = 1;\r\n\t\t\t\t\tvar label = [];\r\n\t\t\t\t\tvar ms = [], se = [],\r\n\t\t\t\t\tpm = [], ie = [];\r\n\t\t\t\t\t\r\n\t\t\t\t\tfor(var x = 0; x < errs.length; x++){\r\n\t\t\t\t\t\tif(errs[x].type == 1){\r\n\t\t\t\t\t\t\tlabel.push(lbl_i);\r\n\t\t\t\t\t\t\tms.push(errs[x].count);\r\n\t\t\t\t\t\t\tlbl_i++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(errs[x].type == 2)\r\n\t\t\t\t\t\t\tse.push(errs[x].count);\r\n\t\t\t\t\t\telse if(errs[x].type == 3)\r\n\t\t\t\t\t\t\tpm.push(errs[x].count);\r\n\t\t\t\t\t\telse if(errs[x].type == 4)\r\n\t\t\t\t\t\t\tie.push(errs[x].count);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar data = {\r\n\t\t\t\t\t    labels: label,\r\n\t\t\t\t\t    datasets: [\r\n\t\t\t\t\t        $scope.getData(\"Missing Semicolon\", ms, 255, 51, 51),\r\n\t\t\t\t\t        $scope.getData(\"Scoping Error\", se, 192, 75, 192),\r\n\t\t\t\t\t        $scope.getData(\"Parenthesis Matching\", pm, 51, 255, 51),\r\n\t\t\t\t\t        $scope.getData(\"Initializer Error\", ie, 255, 255, 51),\r\n\t\t\t\t\t    ]\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tvar myLineChart = new Chart(ctx, {\r\n\t\t\t\t\t    type: 'line',\r\n\t\t\t\t\t    data: data\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tconsole.log(ms);\r\n\t\t\t\t\tconsole.log(se);\r\n\t\t\t\t\tconsole.log(pm);\r\n\t\t\t\t\tconsole.log(ie);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tif(mode == \"single\"){\r\n\t\t\t\t\t\t$scope.noProgress_single = true;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\t$scope.noProgress_multi = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetErrorsCount: function(){\r\n\t\t\t\tuserModel.getAllErrorsCount('single')\r\n\t\t\t\t\t.success(function(response){\r\n\t\t\t\t\t\t$scope.showGraph(response, 'single');\r\n\t\t\t\t\t});\t\r\n\t\t\t\tuserModel.getAllErrorsCount('multiplayer')\r\n\t\t\t\t\t.success(function(response){\r\n\t\t\t\t\t\t$scope.showGraph(response, 'multi');\r\n\t\t\t\t\t});\t\r\n\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t$scope.getErrorsCount();\r\n\r\n\t}]);"],"sourceRoot":"/source/"}